var K=Object.create;var y=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var Z=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var L=r=>y(r,"__esModule",{value:!0});var k=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Q=(r,e,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of V(e))!J.call(r,n)&&n!=="default"&&y(r,n,{get:()=>e[n],enumerable:!(i=M(e,n))||i.enumerable});return r},O=r=>Q(L(y(r!=null?K(Z(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var S=k((ae,P)=>{function $(r){return r==null?[]:Array.isArray(r)?r:[r]}function X(r,e,i,n){var t,l=r[e],s=~n.string.indexOf(e)?i==null||i===!0?"":String(i):typeof i=="boolean"?i:~n.boolean.indexOf(e)?i==="false"?!1:i==="true"||(r._.push((t=+i,t*0==0?t:i)),!!i):(t=+i,t*0==0?t:i);r[e]=l==null?s:Array.isArray(l)?l.concat(s):[l,s]}P.exports=function(r,e){r=r||[],e=e||{};var i,n,t,l,s,a={_:[]},o=0,c=0,h=0,u=r.length;let f=e.alias!==void 0,d=e.unknown!==void 0,b=e.default!==void 0;if(e.alias=e.alias||{},e.string=$(e.string),e.boolean=$(e.boolean),f)for(i in e.alias)for(n=e.alias[i]=$(e.alias[i]),o=0;o<n.length;o++)(e.alias[n[o]]=n.concat(i)).splice(o,1);for(o=e.boolean.length;o-- >0;)for(n=e.alias[e.boolean[o]]||[],c=n.length;c-- >0;)e.boolean.push(n[c]);for(o=e.string.length;o-- >0;)for(n=e.alias[e.string[o]]||[],c=n.length;c-- >0;)e.string.push(n[c]);if(b){for(i in e.default)if(l=typeof e.default[i],n=e.alias[i]=e.alias[i]||[],e[l]!==void 0)for(e[l].push(i),o=0;o<n.length;o++)e[l].push(n[o])}let v=d?Object.keys(e.alias):[];for(o=0;o<u;o++){if(t=r[o],t==="--"){a._=a._.concat(r.slice(++o));break}for(c=0;c<t.length&&t.charCodeAt(c)===45;c++);if(c===0)a._.push(t);else if(t.substring(c,c+3)==="no-"){if(l=t.substring(c+3),d&&!~v.indexOf(l))return e.unknown(t);a[l]=!1}else{for(h=c+1;h<t.length&&t.charCodeAt(h)!==61;h++);for(l=t.substring(c,h),s=t.substring(++h)||o+1===u||(""+r[o+1]).charCodeAt(0)===45||r[++o],n=c===2?[l]:l,h=0;h<n.length;h++){if(l=n[h],d&&!~v.indexOf(l))return e.unknown("-".repeat(c)+l);X(a,l,h+1<n.length||s,e)}}}if(b)for(i in e.default)a[i]===void 0&&(a[i]=e.default[i]);if(f)for(i in a)for(n=e.alias[i]||[];n.length>0;)a[n.shift()]=a[i];return a}});var D=k((ce,G)=>{var T=S(),C="__all__",g="__default__",I=`
`;function R(r){if(!r.length)return"";let e=function(i){let n=0,t=0,l=0,s=i.length;if(s)for(;s--;)t=i[s].length,t>n&&(l=s,n=t);return i[l].length}(r.map(i=>i[0]))+4;return r.map(i=>i[0]+" ".repeat(e-i[0].length)+i[1]+(i[2]==null?"":`  (default ${i[2]})`))}function A(r){return r}function _(r,e,i){if(!e||!e.length)return"";let n=0,t="";for(t+=`
  `+r;n<e.length;n++)t+=`
    `+i(e[n]);return t+I}function j(r,e,i=1){let n=_("ERROR",[e],A);n+=`
  Run \`$ ${r} --help\` for more info.
`,console.error(n),process.exit(i)}var U=class{constructor(e,i){let[n,...t]=e.split(/\s+/);i=i||t.length>0,this.bin=n,this.ver="0.0.0",this.default="",this.tree={},this.command(C),this.command([g].concat(i?t:"<command>").join(" ")),this.single=i,this.curr=""}command(e,i,n={}){if(this.single)throw new Error('Disable "single" mode to add commands');let t=[],l=[],s=/(\[|<)/;if(e.split(/\s+/).forEach(a=>{(s.test(a.charAt(0))?l:t).push(a)}),t=t.join(" "),t in this.tree)throw new Error("Command already exists: "+t);return t.includes("__")||l.unshift(t),l=l.join(" "),this.curr=t,n.default&&(this.default=t),this.tree[t]={usage:l,alibi:[],options:[],alias:{},default:{},examples:[]},n.alias&&this.alias(n.alias),i&&this.describe(i),this}describe(e){return this.tree[this.curr||g].describe=Array.isArray(e)?e:function(i){return(i||"").replace(/([.?!])\s*(?=[A-Z])/g,"$1|").split("|")}(e),this}alias(...e){if(this.single)throw new Error('Cannot call `alias()` in "single" mode');if(!this.curr)throw new Error("Cannot call `alias()` before defining a command");return(this.tree[this.curr].alibi=this.tree[this.curr].alibi.concat(...e)).forEach(i=>this.tree[i]=this.curr),this}option(e,i,n){let t=this.tree[this.curr||C],[l,s]=function(o){return(o||"").split(/^-{1,2}|,|\s+-{1,2}|\s+/).filter(Boolean)}(e);if(s&&s.length>1&&([l,s]=[s,l]),e="--"+l,s&&s.length>0){e=`-${s}, ${e}`;let o=t.alias[s];t.alias[s]=(o||[]).concat(l)}let a=[e,i||""];return n!==void 0?(a.push(n),t.default[l]=n):s||(t.default[l]=void 0),t.options.push(a),this}action(e){return this.tree[this.curr||g].handler=e,this}example(e){return this.tree[this.curr||g].examples.push(e),this}version(e){return this.ver=e,this}parse(e,i={}){e=e.slice();let n,t,l,s,a=2,o=T(e.slice(a),{alias:{h:"help",v:"version"}}),c=this.single,h=this.bin,u="";if(c)s=this.tree[g];else{let p,x=1,F=o._.length+1;for(;x<F;x++)if(n=o._.slice(0,x).join(" "),p=this.tree[n],typeof p=="string")t=(u=p).split(" "),e.splice(e.indexOf(o._[0]),x,...t),x+=t.length-x;else if(p)u=n;else if(u)break;if(s=this.tree[u],l=s===void 0,l){if(this.default)u=this.default,s=this.tree[u],e.unshift(u),a++;else if(n)return j(h,"Invalid command: "+n)}}if(o.help)return this.help(!c&&!l&&u);if(o.version)return this._version();if(!c&&s===void 0)return j(h,"No command specified.");let f=this.tree[C];i.alias=Object.assign(f.alias,s.alias,i.alias),i.default=Object.assign(f.default,s.default,i.default),n=u.split(" "),t=e.indexOf(n[0],2),~t&&e.splice(t,n.length);let d=T(e.slice(a),i);if(!d||typeof d=="string")return j(h,d||"Parsed unknown option flag(s)!");let b=s.usage.split(/\s+/),v=b.filter(p=>p.charAt(0)==="<"),w=d._.splice(0,v.length);if(w.length<v.length)return u&&(h+=" "+u),j(h,"Insufficient arguments!");b.filter(p=>p.charAt(0)==="[").forEach(p=>{w.push(d._.shift())}),w.push(d);let E=s.handler;return i.lazy?{args:w,name:u,handler:E}:E.apply(null,w)}help(e){console.log(function(i,n,t,l){let s="",a=n[t],o="$ "+i,c=n[C],h=f=>`${o} ${f}`.replace(/\s+/g," "),u=[["-h, --help","Displays this message"]];if(t===g&&u.unshift(["-v, --version","Displays current version"]),a.options=(a.options||[]).concat(c.options,u),a.options.length>0&&(a.usage+=" [options]"),s+=_("Description",a.describe,A),s+=_("Usage",[a.usage],h),l||t!==g)l||t===g||(s+=_("Aliases",a.alibi,h));else{let f,d=/^__/,b="",v=[];for(f in n)typeof n[f]=="string"||d.test(f)||v.push([f,(n[f].describe||[""])[0]])<3&&(b+=`
    ${o} ${f} --help`);s+=_("Available Commands",R(v),A),s+="\n  For more info, run any command with the `--help` flag"+b+I}return s+=_("Options",R(a.options),A),s+=_("Examples",a.examples.map(h),A),s}(this.bin,this.tree,e||g,this.single))}_version(){console.log(`${this.bin}, ${this.ver}`)}};G.exports=(r,e)=>new U(r,e)});var B=O(D());var Y="malina-fullstack-app",ee="0.0.1",ie="TCP Server with GUI for debugging TCP connections.",ne="dist/app.js",te="dist/tcpsrv.js",re={build:"node esbuild",dev:"node --enable-source-maps esbuild --dev",prestart:"npm run build",start:"cd dist && node app",cli:"npm run build && node dist/tcpsrv",test:'echo "Error: no test specified" && exit 1'},se="MIT",le={"@mdi/js":"^6.6.96",derver:"^0.5.1",esbuild:"^0.13.12","esbuild-svelte-paths":"^0.1.4","malina-ui":"^0.0.31",malinajs:"^0.6.58","malinajs-router":"^0.1.9",nanoid:"^3.3.2","node-watch":"^0.7.2",sade:"^1.8.1",storxy:"^0.1.12"},H={name:Y,version:ee,description:ie,main:ne,bin:te,scripts:re,license:se,devDependencies:le};var W=O(require("child_process"));function N(r,e,i){(0,W.spawnSync)("node",["app.js"],{cwd:__dirname,windowsHide:!0,stdio:["inherit","inherit","inherit"],env:{...process.env,HOST:r,PORT:e,GUI_PORT:i}})}var q=O(require("net"));function z(r,e){let i=new q.default.Socket;i.connect(e,r,()=>{console.log(arguments),console.log("Connected!"),i.write("Hello!")}),i.on("data",n=>{console.log("IN:  "+n),i.write(n),console.log("OUT:  "+n)}),i.on("close",function(){console.log("Connection closed")}),i.on("error",function(n){console.log("Error: "+n.message)})}(0,B.default)("tcpsrv",!0).version(H.version).describe("Run TCP Server and Web-GUI to debug connections").example("tcpsrv").example("tcpsrv --port 10000").example("tcpsrv --host 0.0.0.0 --port 5050").option("-g, --guiport","Port to bind Web-GUI",7e3).option("-p, --port","Port to bind TCP Server",6969).option("-h, --host","Hostname to bind TCP Server and Web-GUI","localhost").option("-e, --echo","Run echo-client for testing purposes",!1).action(r=>{r.echo?z(r.host,r.port):N(r.host,r.port,r.guiport)}).parse(process.argv);
