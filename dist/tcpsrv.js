var J=Object.create;var O=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty;var L=r=>O(r,"__esModule",{value:!0});var S=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Q=(r,e,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of M(e))!Z.call(r,n)&&n!=="default"&&O(r,n,{get:()=>e[n],enumerable:!(i=K(e,n))||i.enumerable});return r},y=r=>Q(L(O(r!=null?J(V(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var P=S((ae,k)=>{function $(r){return r==null?[]:Array.isArray(r)?r:[r]}function X(r,e,i,n){var t,s=r[e],o=~n.string.indexOf(e)?i==null||i===!0?"":String(i):typeof i=="boolean"?i:~n.boolean.indexOf(e)?i==="false"?!1:i==="true"||(r._.push((t=+i,t*0==0?t:i)),!!i):(t=+i,t*0==0?t:i);r[e]=s==null?o:Array.isArray(s)?s.concat(o):[s,o]}k.exports=function(r,e){r=r||[],e=e||{};var i,n,t,s,o,a={_:[]},l=0,h=0,c=0,u=r.length;let f=e.alias!==void 0,d=e.unknown!==void 0,b=e.default!==void 0;if(e.alias=e.alias||{},e.string=$(e.string),e.boolean=$(e.boolean),f)for(i in e.alias)for(n=e.alias[i]=$(e.alias[i]),l=0;l<n.length;l++)(e.alias[n[l]]=n.concat(i)).splice(l,1);for(l=e.boolean.length;l-- >0;)for(n=e.alias[e.boolean[l]]||[],h=n.length;h-- >0;)e.boolean.push(n[h]);for(l=e.string.length;l-- >0;)for(n=e.alias[e.string[l]]||[],h=n.length;h-- >0;)e.string.push(n[h]);if(b){for(i in e.default)if(s=typeof e.default[i],n=e.alias[i]=e.alias[i]||[],e[s]!==void 0)for(e[s].push(i),l=0;l<n.length;l++)e[s].push(n[l])}let v=d?Object.keys(e.alias):[];for(l=0;l<u;l++){if(t=r[l],t==="--"){a._=a._.concat(r.slice(++l));break}for(h=0;h<t.length&&t.charCodeAt(h)===45;h++);if(h===0)a._.push(t);else if(t.substring(h,h+3)==="no-"){if(s=t.substring(h+3),d&&!~v.indexOf(s))return e.unknown(t);a[s]=!1}else{for(c=h+1;c<t.length&&t.charCodeAt(c)!==61;c++);for(s=t.substring(h,c),o=t.substring(++c)||l+1===u||(""+r[l+1]).charCodeAt(0)===45||r[++l],n=h===2?[s]:s,c=0;c<n.length;c++){if(s=n[c],d&&!~v.indexOf(s))return e.unknown("-".repeat(h)+s);X(a,s,c+1<n.length||o,e)}}}if(b)for(i in e.default)a[i]===void 0&&(a[i]=e.default[i]);if(f)for(i in a)for(n=e.alias[i]||[];n.length>0;)a[n.shift()]=a[i];return a}});var G=S((he,D)=>{var T=P(),j="__all__",g="__default__",I=`
`;function R(r){if(!r.length)return"";let e=function(i){let n=0,t=0,s=0,o=i.length;if(o)for(;o--;)t=i[o].length,t>n&&(s=o,n=t);return i[s].length}(r.map(i=>i[0]))+4;return r.map(i=>i[0]+" ".repeat(e-i[0].length)+i[1]+(i[2]==null?"":`  (default ${i[2]})`))}function C(r){return r}function _(r,e,i){if(!e||!e.length)return"";let n=0,t="";for(t+=`
  `+r;n<e.length;n++)t+=`
    `+i(e[n]);return t+I}function A(r,e,i=1){let n=_("ERROR",[e],C);n+=`
  Run \`$ ${r} --help\` for more info.
`,console.error(n),process.exit(i)}var U=class{constructor(e,i){let[n,...t]=e.split(/\s+/);i=i||t.length>0,this.bin=n,this.ver="0.0.0",this.default="",this.tree={},this.command(j),this.command([g].concat(i?t:"<command>").join(" ")),this.single=i,this.curr=""}command(e,i,n={}){if(this.single)throw new Error('Disable "single" mode to add commands');let t=[],s=[],o=/(\[|<)/;if(e.split(/\s+/).forEach(a=>{(o.test(a.charAt(0))?s:t).push(a)}),t=t.join(" "),t in this.tree)throw new Error("Command already exists: "+t);return t.includes("__")||s.unshift(t),s=s.join(" "),this.curr=t,n.default&&(this.default=t),this.tree[t]={usage:s,alibi:[],options:[],alias:{},default:{},examples:[]},n.alias&&this.alias(n.alias),i&&this.describe(i),this}describe(e){return this.tree[this.curr||g].describe=Array.isArray(e)?e:function(i){return(i||"").replace(/([.?!])\s*(?=[A-Z])/g,"$1|").split("|")}(e),this}alias(...e){if(this.single)throw new Error('Cannot call `alias()` in "single" mode');if(!this.curr)throw new Error("Cannot call `alias()` before defining a command");return(this.tree[this.curr].alibi=this.tree[this.curr].alibi.concat(...e)).forEach(i=>this.tree[i]=this.curr),this}option(e,i,n){let t=this.tree[this.curr||j],[s,o]=function(l){return(l||"").split(/^-{1,2}|,|\s+-{1,2}|\s+/).filter(Boolean)}(e);if(o&&o.length>1&&([s,o]=[o,s]),e="--"+s,o&&o.length>0){e=`-${o}, ${e}`;let l=t.alias[o];t.alias[o]=(l||[]).concat(s)}let a=[e,i||""];return n!==void 0?(a.push(n),t.default[s]=n):o||(t.default[s]=void 0),t.options.push(a),this}action(e){return this.tree[this.curr||g].handler=e,this}example(e){return this.tree[this.curr||g].examples.push(e),this}version(e){return this.ver=e,this}parse(e,i={}){e=e.slice();let n,t,s,o,a=2,l=T(e.slice(a),{alias:{h:"help",v:"version"}}),h=this.single,c=this.bin,u="";if(h)o=this.tree[g];else{let p,x=1,F=l._.length+1;for(;x<F;x++)if(n=l._.slice(0,x).join(" "),p=this.tree[n],typeof p=="string")t=(u=p).split(" "),e.splice(e.indexOf(l._[0]),x,...t),x+=t.length-x;else if(p)u=n;else if(u)break;if(o=this.tree[u],s=o===void 0,s){if(this.default)u=this.default,o=this.tree[u],e.unshift(u),a++;else if(n)return A(c,"Invalid command: "+n)}}if(l.help)return this.help(!h&&!s&&u);if(l.version)return this._version();if(!h&&o===void 0)return A(c,"No command specified.");let f=this.tree[j];i.alias=Object.assign(f.alias,o.alias,i.alias),i.default=Object.assign(f.default,o.default,i.default),n=u.split(" "),t=e.indexOf(n[0],2),~t&&e.splice(t,n.length);let d=T(e.slice(a),i);if(!d||typeof d=="string")return A(c,d||"Parsed unknown option flag(s)!");let b=o.usage.split(/\s+/),v=b.filter(p=>p.charAt(0)==="<"),w=d._.splice(0,v.length);if(w.length<v.length)return u&&(c+=" "+u),A(c,"Insufficient arguments!");b.filter(p=>p.charAt(0)==="[").forEach(p=>{w.push(d._.shift())}),w.push(d);let E=o.handler;return i.lazy?{args:w,name:u,handler:E}:E.apply(null,w)}help(e){console.log(function(i,n,t,s){let o="",a=n[t],l="$ "+i,h=n[j],c=f=>`${l} ${f}`.replace(/\s+/g," "),u=[["-h, --help","Displays this message"]];if(t===g&&u.unshift(["-v, --version","Displays current version"]),a.options=(a.options||[]).concat(h.options,u),a.options.length>0&&(a.usage+=" [options]"),o+=_("Description",a.describe,C),o+=_("Usage",[a.usage],c),s||t!==g)s||t===g||(o+=_("Aliases",a.alibi,c));else{let f,d=/^__/,b="",v=[];for(f in n)typeof n[f]=="string"||d.test(f)||v.push([f,(n[f].describe||[""])[0]])<3&&(b+=`
    ${l} ${f} --help`);o+=_("Available Commands",R(v),C),o+="\n  For more info, run any command with the `--help` flag"+b+I}return o+=_("Options",R(a.options),C),o+=_("Examples",a.examples.map(c),C),o}(this.bin,this.tree,e||g,this.single))}_version(){console.log(`${this.bin}, ${this.ver}`)}};D.exports=(r,e)=>new U(r,e)});var B=y(G());var Y="malina-fullstack-app",ee="0.0.1",ie="TCP Server with GUI for debugging TCP connections.",ne="dist/app.js",te="dist/tcpsrv.js",re={build:"node esbuild",dev:"node --enable-source-maps esbuild --dev",prestart:"npm run build",start:"cd dist && node app",cli:"npm run build && node dist/tcpsrv",test:'echo "Error: no test specified" && exit 1'},se="MIT",oe={"@mdi/js":"^6.6.96",derver:"^0.5.1",esbuild:"^0.13.12","esbuild-svelte-paths":"^0.1.4","malina-ui":"^0.0.31",malinajs:"^0.6.58","malinajs-router":"^0.1.9",nanoid:"^3.3.2","node-watch":"^0.7.2",sade:"^1.8.1",storxy:"^0.1.12"},H={name:Y,version:ee,description:ie,main:ne,bin:te,scripts:re,license:se,devDependencies:oe};var N=y(require("child_process"));function W(r,e,i){(0,N.spawnSync)("node",["app.js"],{cwd:__dirname,windowsHide:!0,stdio:["inherit","inherit","inherit"],env:{...process.env,HOST:r,PORT:e,GUI_PORT:i}})}var q=y(require("net"));function z(r,e){let i=new q.default.Socket;i.connect(e,r,()=>{console.log("Connected!"),i.write("Hello!")}),i.on("data",n=>{let t=n.toJSON().data.map(s=>s.toString(16).padStart(2,"0").toUpperCase()).join(" ");console.log(" IN: "+t),i.write(n),console.log("OUT: "+t)}),i.on("close",function(){console.log("Connection closed")}),i.on("error",function(n){console.log("Error: "+n.message)})}(0,B.default)("tcpsrv",!0).version(H.version).describe("Run TCP Server and Web-GUI to debug connections").example("tcpsrv").example("tcpsrv --port 10000").example("tcpsrv --host 0.0.0.0 --port 5050").option("-g, --guiport","Port to bind Web-GUI",7e3).option("-p, --port","Port to bind TCP Server",6969).option("-h, --host","Hostname to bind TCP Server and Web-GUI","localhost").option("-e, --echo","Run echo-client for testing purposes",!1).action(r=>{r.echo?z(r.host,r.port):W(r.host,r.port,r.guiport)}).parse(process.argv);
